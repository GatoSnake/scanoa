<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:ui="http://java.sun.com/jsf/facelets"  
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">
<h:body>
	<ui:composition template="/templates/loginTemplate.xhtml">
		<ui:define name="title">Recuperación de Cuenta - SCANOA</ui:define>
		<ui:define name="content">
			<div id="formRec">
				<f:metadata>
					<f:viewParam name="code" value="#{recoveryAccountBean.code}" />
					<f:viewParam name="email" value="#{recoveryAccountBean.correoRAB}" />
					<f:event listener="#{recoveryAccountBean.init}" type="preRenderView" />
					<f:attribute name="code" value="#{recoveryAccountBean.code}" />
					<f:attribute name="email" value="#{recoveryAccountBean.correoRAB}" />
				</f:metadata>
		    	<p:outputPanel id="panel0" layout="block" rendered="#{recoveryAccountBean.showRecovery==0}">
					<h:form id="recForm">
				    	<h3>Recuperación de cuenta</h3>
				    	<p:growl id="msgsRec" showDetail="true" globalOnly="true"/>
					    <table>
					    	<tr>
					    		<td colspan="2">
					    			<p style="text-align:center;">Se enviará un mail a su correo electrónico para confirmar la recuperación de la cuenta</p>
					    		</td>
					    	</tr>
					    	<tr>
					    		<td><h:outputText value="Ingrese su correo electrónico: " /></td>
					    		<td>
					    			<p:inputText id="recCorreo" value="#{recoveryAccountBean.correoRAB}" required="true" requiredMessage="Debe ingresar un correo electrónico.">
										<f:validator validatorId="correoValidator" />
									</p:inputText>
					    		</td>
					    	</tr>
					    	<tr>
					    		<td colspan="2"><p:message for="recCorreo" severity="error"></p:message></td>
					    	</tr>
					    	<tr>
					    		<td>
					    			<p:commandButton action="#{recoveryAccountBean.sendMail}" value="Enviar" update=":recForm" ajax="true" icon="ui-icon-mail-closed" />
					    		</td>
					    		<td><p:button outcome="login" value="Volver" icon="ui-icon-circle-close"/></td>
					    	</tr>
					    </table>
					</h:form>
				</p:outputPanel>
				
				<p:outputPanel id="panel1" layout="block" rendered="#{recoveryAccountBean.showRecovery==1}">
					<h:form id="restPass">
						<h3>Restablecer contraseña</h3>
						<h:inputHidden value="#{recoveryAccountBean.code}" id="hidden1" />
						<h:inputHidden value="#{recoveryAccountBean.correoRAB}" id="hidden2" />
						<table>
							<tr>
								<td>Ingrese su contraseña</td>
								<td>
									<p:password id="contraseña" value="#{recoveryAccountBean.newPass}" feedback="false" 
										match="confContraseña"
										validatorMessage="Las contraseñas no coinciden."
										required="true" requiredMessage="Debe ingresar su contraseña."/>
								</td>
							</tr>
							<tr>
								<td colspan="2"><p:message for="contraseña" severity="error"></p:message></td>
							</tr>
							<tr>
								<td>Confirme su contraseña</td>
								<td>
									<p:password id="confContraseña" value="#{recoveryAccountBean.newPass}" feedback="false" 
										required="true" requiredMessage="Debe confirmar su contraseña."/>
								</td>
							</tr>
							<tr>
								<td colspan="2"><p:message for="confContraseña" severity="error"></p:message></td>
							</tr>
							<tr>
					    		<td>
					    			<p:commandButton action="#{recoveryAccountBean.restablecerPass}" value="Aceptar" update=":restPass" ajax="true" icon="ui-icon-mail-closed" />
					    		</td>
					    		<td><p:button outcome="login" value="Cancelar" icon="ui-icon-circle-close"/></td>
					    	</tr>
						</table>
					</h:form>
		    	</p:outputPanel>
			</div>
			
			<p:ajaxStatus onstart="PF('statusDialog').show()" onsuccess="PF('statusDialog').hide()" />
			<p:dialog widgetVar="statusDialog" modal="false" draggable="false" closable="false" resizable="false" showHeader="false">
			    <p:graphicImage name="img/ajaxloader.gif" />
			</p:dialog>
			
		</ui:define>	
	</ui:composition>
</h:body>
</html>